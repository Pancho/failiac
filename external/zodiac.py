import logging


from . import utils


logger = logging.getLogger(__name__)


TABLE = {
	# January
	(1, 1): 'Capricorn',
	(2, 1): 'Capricorn',
	(3, 1): 'Capricorn',
	(4, 1): 'Capricorn',
	(5, 1): 'Capricorn',
	(6, 1): 'Capricorn',
	(7, 1): 'Capricorn',
	(8, 1): 'Capricorn',
	(9, 1): 'Capricorn',
	(10, 1): 'Capricorn',
	(11, 1): 'Capricorn',
	(12, 1): 'Capricorn',
	(13, 1): 'Capricorn',
	(14, 1): 'Capricorn',
	(15, 1): 'Capricorn',
	(16, 1): 'Capricorn',
	(17, 1): 'Capricorn',
	(18, 1): 'Capricorn',
	(19, 1): 'Capricorn',
	(20, 1): 'Aquarius',
	(21, 1): 'Aquarius',
	(22, 1): 'Aquarius',
	(23, 1): 'Aquarius',
	(24, 1): 'Aquarius',
	(25, 1): 'Aquarius',
	(26, 1): 'Aquarius',
	(27, 1): 'Aquarius',
	(28, 1): 'Aquarius',
	(29, 1): 'Aquarius',
	(30, 1): 'Aquarius',
	(31, 1): 'Aquarius',
	# February
	(1, 2): 'Aquarius',
	(2, 2): 'Aquarius',
	(3, 2): 'Aquarius',
	(4, 2): 'Aquarius',
	(5, 2): 'Aquarius',
	(6, 2): 'Aquarius',
	(7, 2): 'Aquarius',
	(8, 2): 'Aquarius',
	(9, 2): 'Aquarius',
	(10, 2): 'Aquarius',
	(11, 2): 'Aquarius',
	(12, 2): 'Aquarius',
	(13, 2): 'Aquarius',
	(14, 2): 'Aquarius',
	(15, 2): 'Aquarius',
	(16, 2): 'Aquarius',
	(17, 2): 'Aquarius',
	(18, 2): 'Aquarius',
	(19, 2): 'Pisces',
	(20, 2): 'Pisces',
	(21, 2): 'Pisces',
	(22, 2): 'Pisces',
	(23, 2): 'Pisces',
	(24, 2): 'Pisces',
	(25, 2): 'Pisces',
	(26, 2): 'Pisces',
	(27, 2): 'Pisces',
	(28, 2): 'Pisces',
	# (29, 2): 'Pisces',
	# March
	(1, 3): 'Pisces',
	(2, 3): 'Pisces',
	(3, 3): 'Pisces',
	(4, 3): 'Pisces',
	(5, 3): 'Pisces',
	(6, 3): 'Pisces',
	(7, 3): 'Pisces',
	(8, 3): 'Pisces',
	(9, 3): 'Pisces',
	(10, 3): 'Pisces',
	(11, 3): 'Pisces',
	(12, 3): 'Pisces',
	(13, 3): 'Pisces',
	(14, 3): 'Pisces',
	(15, 3): 'Pisces',
	(16, 3): 'Pisces',
	(17, 3): 'Pisces',
	(18, 3): 'Pisces',
	(19, 3): 'Pisces',
	(20, 3): 'Pisces',
	(21, 3): 'Aries',
	(22, 3): 'Aries',
	(23, 3): 'Aries',
	(24, 3): 'Aries',
	(25, 3): 'Aries',
	(26, 3): 'Aries',
	(27, 3): 'Aries',
	(28, 3): 'Aries',
	(29, 3): 'Aries',
	(30, 3): 'Aries',
	(31, 3): 'Aries',
	# April
	(1, 4): 'Aries',
	(2, 4): 'Aries',
	(3, 4): 'Aries',
	(4, 4): 'Aries',
	(5, 4): 'Aries',
	(6, 4): 'Aries',
	(7, 4): 'Aries',
	(8, 4): 'Aries',
	(9, 4): 'Aries',
	(10, 4): 'Aries',
	(11, 4): 'Aries',
	(12, 4): 'Aries',
	(13, 4): 'Aries',
	(14, 4): 'Aries',
	(15, 4): 'Aries',
	(16, 4): 'Aries',
	(17, 4): 'Aries',
	(18, 4): 'Aries',
	(19, 4): 'Aries',
	(20, 4): 'Taurus',
	(21, 4): 'Taurus',
	(22, 4): 'Taurus',
	(23, 4): 'Taurus',
	(24, 4): 'Taurus',
	(25, 4): 'Taurus',
	(26, 4): 'Taurus',
	(27, 4): 'Taurus',
	(28, 4): 'Taurus',
	(29, 4): 'Taurus',
	(30, 4): 'Taurus',
	# May
	(1, 5): 'Taurus',
	(2, 5): 'Taurus',
	(3, 5): 'Taurus',
	(4, 5): 'Taurus',
	(5, 5): 'Taurus',
	(6, 5): 'Taurus',
	(7, 5): 'Taurus',
	(8, 5): 'Taurus',
	(9, 5): 'Taurus',
	(10, 5): 'Taurus',
	(11, 5): 'Taurus',
	(12, 5): 'Taurus',
	(13, 5): 'Taurus',
	(14, 5): 'Taurus',
	(15, 5): 'Taurus',
	(16, 5): 'Taurus',
	(17, 5): 'Taurus',
	(18, 5): 'Taurus',
	(19, 5): 'Taurus',
	(20, 5): 'Taurus',
	(21, 5): 'Gemini',
	(22, 5): 'Gemini',
	(23, 5): 'Gemini',
	(24, 5): 'Gemini',
	(25, 5): 'Gemini',
	(26, 5): 'Gemini',
	(27, 5): 'Gemini',
	(28, 5): 'Gemini',
	(29, 5): 'Gemini',
	(30, 5): 'Gemini',
	(31, 5): 'Gemini',
	# June
	(1, 6): 'Gemini',
	(2, 6): 'Gemini',
	(3, 6): 'Gemini',
	(4, 6): 'Gemini',
	(5, 6): 'Gemini',
	(6, 6): 'Gemini',
	(7, 6): 'Gemini',
	(8, 6): 'Gemini',
	(9, 6): 'Gemini',
	(10, 6): 'Gemini',
	(11, 6): 'Gemini',
	(12, 6): 'Gemini',
	(13, 6): 'Gemini',
	(14, 6): 'Gemini',
	(15, 6): 'Gemini',
	(16, 6): 'Gemini',
	(17, 6): 'Gemini',
	(18, 6): 'Gemini',
	(19, 6): 'Gemini',
	(20, 6): 'Gemini',
	(21, 6): 'Cancer',
	(22, 6): 'Cancer',
	(23, 6): 'Cancer',
	(24, 6): 'Cancer',
	(25, 6): 'Cancer',
	(26, 6): 'Cancer',
	(27, 6): 'Cancer',
	(28, 6): 'Cancer',
	(29, 6): 'Cancer',
	(30, 6): 'Cancer',
	# July
	(1, 7): 'Cancer',
	(2, 7): 'Cancer',
	(3, 7): 'Cancer',
	(4, 7): 'Cancer',
	(5, 7): 'Cancer',
	(6, 7): 'Cancer',
	(7, 7): 'Cancer',
	(8, 7): 'Cancer',
	(9, 7): 'Cancer',
	(10, 7): 'Cancer',
	(11, 7): 'Cancer',
	(12, 7): 'Cancer',
	(13, 7): 'Cancer',
	(14, 7): 'Cancer',
	(15, 7): 'Cancer',
	(16, 7): 'Cancer',
	(17, 7): 'Cancer',
	(18, 7): 'Cancer',
	(19, 7): 'Cancer',
	(20, 7): 'Cancer',
	(21, 7): 'Cancer',
	(22, 7): 'Cancer',
	(23, 7): 'Leo',
	(24, 7): 'Leo',
	(25, 7): 'Leo',
	(26, 7): 'Leo',
	(27, 7): 'Leo',
	(28, 7): 'Leo',
	(29, 7): 'Leo',
	(30, 7): 'Leo',
	(31, 7): 'Leo',
	# August
	(1, 8): 'Leo',
	(2, 8): 'Leo',
	(3, 8): 'Leo',
	(4, 8): 'Leo',
	(5, 8): 'Leo',
	(6, 8): 'Leo',
	(7, 8): 'Leo',
	(8, 8): 'Leo',
	(9, 8): 'Leo',
	(10, 8): 'Leo',
	(11, 8): 'Leo',
	(12, 8): 'Leo',
	(13, 8): 'Leo',
	(14, 8): 'Leo',
	(15, 8): 'Leo',
	(16, 8): 'Leo',
	(17, 8): 'Leo',
	(18, 8): 'Leo',
	(19, 8): 'Leo',
	(20, 8): 'Leo',
	(21, 8): 'Leo',
	(22, 8): 'Leo',
	(23, 8): 'Virgo',
	(24, 8): 'Virgo',
	(25, 8): 'Virgo',
	(26, 8): 'Virgo',
	(27, 8): 'Virgo',
	(28, 8): 'Virgo',
	(29, 8): 'Virgo',
	(30, 8): 'Virgo',
	(31, 8): 'Virgo',
	# September
	(1, 9): 'Virgo',
	(2, 9): 'Virgo',
	(3, 9): 'Virgo',
	(4, 9): 'Virgo',
	(5, 9): 'Virgo',
	(6, 9): 'Virgo',
	(7, 9): 'Virgo',
	(8, 9): 'Virgo',
	(9, 9): 'Virgo',
	(10, 9): 'Virgo',
	(11, 9): 'Virgo',
	(12, 9): 'Virgo',
	(13, 9): 'Virgo',
	(14, 9): 'Virgo',
	(15, 9): 'Virgo',
	(16, 9): 'Virgo',
	(17, 9): 'Virgo',
	(18, 9): 'Virgo',
	(19, 9): 'Virgo',
	(20, 9): 'Virgo',
	(21, 9): 'Virgo',
	(22, 9): 'Virgo',
	(23, 9): 'Libra',
	(24, 9): 'Libra',
	(25, 9): 'Libra',
	(26, 9): 'Libra',
	(27, 9): 'Libra',
	(28, 9): 'Libra',
	(29, 9): 'Libra',
	(30, 9): 'Libra',
	# October
	(1, 10): 'Libra',
	(2, 10): 'Libra',
	(3, 10): 'Libra',
	(4, 10): 'Libra',
	(5, 10): 'Libra',
	(6, 10): 'Libra',
	(7, 10): 'Libra',
	(8, 10): 'Libra',
	(9, 10): 'Libra',
	(10, 10): 'Libra',
	(11, 10): 'Libra',
	(12, 10): 'Libra',
	(13, 10): 'Libra',
	(14, 10): 'Libra',
	(15, 10): 'Libra',
	(16, 10): 'Libra',
	(17, 10): 'Libra',
	(18, 10): 'Libra',
	(19, 10): 'Libra',
	(20, 10): 'Libra',
	(21, 10): 'Libra',
	(22, 10): 'Libra',
	(23, 10): 'Libra',
	(24, 10): 'Scorpio',
	(25, 10): 'Scorpio',
	(26, 10): 'Scorpio',
	(27, 10): 'Scorpio',
	(28, 10): 'Scorpio',
	(29, 10): 'Scorpio',
	(30, 10): 'Scorpio',
	(31, 10): 'Scorpio',
	# November
	(1, 11): 'Scorpio',
	(2, 11): 'Scorpio',
	(3, 11): 'Scorpio',
	(4, 11): 'Scorpio',
	(5, 11): 'Scorpio',
	(6, 11): 'Scorpio',
	(7, 11): 'Scorpio',
	(8, 11): 'Scorpio',
	(9, 11): 'Scorpio',
	(10, 11): 'Scorpio',
	(11, 11): 'Scorpio',
	(12, 11): 'Scorpio',
	(13, 11): 'Scorpio',
	(14, 11): 'Scorpio',
	(15, 11): 'Scorpio',
	(16, 11): 'Scorpio',
	(17, 11): 'Scorpio',
	(18, 11): 'Scorpio',
	(19, 11): 'Scorpio',
	(20, 11): 'Scorpio',
	(21, 11): 'Scorpio',
	(22, 11): 'Sagittarius',
	(23, 11): 'Sagittarius',
	(24, 11): 'Sagittarius',
	(25, 11): 'Sagittarius',
	(26, 11): 'Sagittarius',
	(27, 11): 'Sagittarius',
	(28, 11): 'Sagittarius',
	(29, 11): 'Sagittarius',
	(30, 11): 'Sagittarius',
	# December
	(1, 12): 'Sagittarius',
	(2, 12): 'Sagittarius',
	(3, 12): 'Sagittarius',
	(4, 12): 'Sagittarius',
	(5, 12): 'Sagittarius',
	(6, 12): 'Sagittarius',
	(7, 12): 'Sagittarius',
	(8, 12): 'Sagittarius',
	(9, 12): 'Sagittarius',
	(10, 12): 'Sagittarius',
	(11, 12): 'Sagittarius',
	(12, 12): 'Sagittarius',
	(13, 12): 'Sagittarius',
	(14, 12): 'Sagittarius',
	(15, 12): 'Sagittarius',
	(16, 12): 'Sagittarius',
	(17, 12): 'Sagittarius',
	(18, 12): 'Sagittarius',
	(19, 12): 'Sagittarius',
	(20, 12): 'Sagittarius',
	(21, 12): 'Sagittarius',
	(22, 12): 'Capricorn',
	(23, 12): 'Capricorn',
	(24, 12): 'Capricorn',
	(25, 12): 'Capricorn',
	(26, 12): 'Capricorn',
	(27, 12): 'Capricorn',
	(28, 12): 'Capricorn',
	(29, 12): 'Capricorn',
	(30, 12): 'Capricorn',
	(31, 12): 'Capricorn',
}


TABLE_AS_JSON = {
	'{},{}'.format(date_tuple[0], date_tuple[1]): sign for date_tuple, sign in TABLE.items()
}


# Percentages
PROBABILITIES_FOR_MONGO = utils.update_statistical_data({
	'members': len(list(TABLE.keys())),
	'distribution': {
		sign: len([x for x in TABLE.keys() if TABLE[x] == sign]) for day_month, sign in TABLE.items()
	},
	'distributionPercentages': {
		sign: len([x for x in TABLE.keys() if TABLE[x] == sign]) / len(TABLE) for day_month, sign in TABLE.items()
	},
	'profession': 'Birthed',
})


ORDER = ['Aries', 'Taurus', 'Gemini', 'Cancer', 'Leo', 'Virgo', 'Libra', 'Scorpio', 'Sagittarius', 'Capricorn', 'Aquarius', 'Pisces']


def get_empty_distribution():
	return {
		'Leo': 0,
		'Pisces': 0,
		'Scorpio': 0,
		'Cancer': 0,
		'Gemini': 0,
		'Libra': 0,
		'Taurus': 0,
		'Sagittarius': 0,
		'Virgo': 0,
		'Capricorn': 0,
		'Aquarius': 0,
		'Aries': 0,
	}


def convert_to_percentages(distribution):
	result = {}

	for sign, count in distribution.items():
		result[sign] = count / sum([per_sign for per_sign in distribution.values()])

	return result


def get_zodiac(date):
	if date is None:
		return None

	# Leap year
	if date.day == 29 and date.month == 2:
		return 'Pisces'

	return TABLE.get((date.day, date.month))
